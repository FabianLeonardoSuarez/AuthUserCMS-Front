import React, { Component } from 'react';
import "./userbar.scss";
import AuthenticationService from "../../services/autentication/autentication"
import UserService from '../../services/UserService';

class Userbar extends Component{
    constructor(props){
        super(props);
        this.state = {            
            userInfo: null,            
        };
        this.getUserInfo = this.getUserInfo.bind(this);
    }  

    async getUserInfo() {
        const dataObj = new UserService();
        await dataObj.getUserInfo().then((data) => {
          if (data) {    
            console.log(data);
            this.setState({
                userInfo: data,                                
            });            
          }
        });    
    }

    componentDidMount() {        
        this.getUserInfo();
    }

    render(){
        return(
        <div className='primarybar'>
            <h1>ArandaSoft</h1>
            <div className='userinfo'>
                <div className='userinitials'>
                <h1>{this.state.userInfo?this.state.userInfo.UserName[0].toUpperCase():""}{this.state.userInfo?this.state.userInfo.Fullname[0].toUpperCase():""}</h1>
                <svg width="70" height="70" viewBox="0 0 814 812" fill="none" xmlns="http://www.w3.org/2000/svg">
<circle cx="403.5" cy="408.5" r="403.5" fill="#C4C4C4"/>
<path d="M408.49 0.980469C184.902 0.980469 2.98 182.902 2.98 406.49C2.98 526.301 55.257 634.116 138.15 708.409V708.696L144.03 713.765C145.06 714.661 146.193 715.404 147.24 716.283C154.522 722.433 162.024 728.33 169.729 733.973C171.807 735.494 173.885 736.964 175.997 738.434C184.175 744.178 192.539 749.653 201.122 754.789C202.558 755.651 204.028 756.462 205.465 757.29C214.876 762.764 224.49 767.918 234.357 772.632C234.458 772.682 234.56 772.716 234.661 772.767C255.765 782.82 277.899 791.049 300.81 797.368C301.232 797.486 301.655 797.621 302.077 797.723C312.908 800.679 323.924 803.163 335.092 805.208C336.14 805.394 337.171 805.579 338.218 805.765C348.998 807.658 359.913 809.161 370.98 810.192C372.247 810.31 373.515 810.378 374.765 810.479C385.899 811.409 397.119 812 408.49 812C419.861 812 431.08 811.409 442.215 810.479C443.482 810.378 444.749 810.31 445.999 810.192C457.066 809.178 467.981 807.658 478.761 805.765C479.809 805.579 480.839 805.394 481.887 805.208C493.055 803.163 504.072 800.679 514.902 797.723C515.325 797.604 515.747 797.486 516.169 797.368C539.081 791.049 561.215 782.82 582.318 772.767C582.42 772.716 582.521 772.682 582.622 772.632C592.49 767.918 602.104 762.747 611.515 757.29C612.968 756.445 614.421 755.651 615.857 754.789C624.457 749.653 632.821 744.162 640.982 738.434C643.077 736.964 645.172 735.494 647.251 733.973C654.955 728.33 662.457 722.433 669.739 716.283C670.787 715.404 671.919 714.661 672.95 713.765L678.83 708.696V708.409C761.723 634.099 814 526.301 814 406.49C814 182.902 632.078 0.980469 408.49 0.980469ZM408.49 406.49C333.96 406.49 273.32 345.85 273.32 271.32C273.32 196.791 333.96 136.15 408.49 136.15C483.019 136.15 543.66 196.791 543.66 271.32C543.66 345.85 483.019 406.49 408.49 406.49ZM459.178 440.283C561.654 440.283 645.037 523.666 645.037 626.141V693.017C644.327 693.608 643.584 694.149 642.874 694.74C636.2 700.164 629.357 705.317 622.362 710.251C620.808 711.349 619.287 712.481 617.733 713.546C610.18 718.699 602.425 723.531 594.534 728.11C593.098 728.955 591.645 729.783 590.192 730.611C581.913 735.257 573.482 739.617 564.881 743.604C563.986 744.026 563.073 744.432 562.161 744.837C534.096 757.594 504.528 766.836 474.098 772.311C473.135 772.48 472.172 772.666 471.209 772.835C461.628 774.473 451.964 775.741 442.232 776.636C440.897 776.754 439.545 776.839 438.193 776.94C428.343 777.701 418.442 778.208 408.49 778.208C398.538 778.208 388.637 777.701 378.786 776.907C377.451 776.805 376.1 776.721 374.748 776.602C365.016 775.707 355.351 774.457 345.771 772.801C344.808 772.632 343.845 772.463 342.882 772.277C312.452 766.803 282.883 757.56 254.818 744.804C253.906 744.381 252.994 743.993 252.098 743.57C243.498 739.583 235.067 735.223 226.788 730.577C225.335 729.749 223.898 728.921 222.445 728.076C214.555 723.514 206.799 718.665 199.247 713.512C197.675 712.447 196.155 711.315 194.617 710.217C187.622 705.283 180.779 700.147 174.105 694.706C173.395 694.132 172.652 693.574 171.942 692.983V626.141C171.942 523.666 255.325 440.283 357.801 440.283H459.178ZM678.83 661.218V626.141C678.83 520.185 603.405 431.514 503.447 410.968C548.07 380.538 577.452 329.291 577.452 271.32C577.452 178.154 501.656 102.358 408.49 102.358C315.324 102.358 239.527 178.154 239.527 271.32C239.527 329.291 268.91 380.538 313.533 410.968C213.575 431.514 138.15 520.185 138.15 626.141V661.218C75.3635 594.63 36.7725 505.012 36.7725 406.49C36.7725 201.522 203.521 34.7729 408.49 34.7729C613.458 34.7729 780.207 201.522 780.207 406.49C780.207 505.012 741.616 594.63 678.83 661.218Z" fill="#9B9B9B"/>
                </svg>
                </div>
                <div className='userwelcome'>
                    <p>Bienvenido {this.state.userInfo?this.state.userInfo.UserName:""}</p>
                    <a onClick={()=> (new AuthenticationService).logout() }>Salir</a>                    
                </div>
            </div>
        </div>
        
        );
    }
}

export default Userbar;